<h1> <img align="center" src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/3ee2f20c-f0bb-4abf-9fac-a32bdd14b0e1"> -----^-----Vulnerability Management with Nessus-----^----- </h1>

<h2> <p align="center"> Project Description </p> </h2>
According to the Cybersecurity & Infrastructure Security Agency (CISA), the mission of vulnerability management is to reduce the prevalence and impact of vulnerabilities and exploitable conditions across enterprises and technologies, including through assessments and coordinated disclosure of vulnerabilities reported by trusted partners. For this project I used Tenable Nessus to conduct a vulnerability assessment on a Windows Virtual Machine (VM). Following the vulnerability management lifecycle, I was able to assess, prioritize, take action, reassess and improve on this process. Let’s get to work!

<h2> <p align="center"> Setup </p> </h2> 
I utilized Oracle VM VirtualBox as the virtualization software to create the necessary VMs for this project. Within a Kali Linux VM, I downloaded Nessus Essentials. This version offers the same high-speed, in-depth assessments and agentless scanning convenience as Nessus subscribers enjoy. However, it's limited to scanning up to 16 IP addresses. Additionally, I set up a Windows 10 VM, designated as the target machine for my experimentation.  
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/98596bd7-14b6-4a66-9f47-51a5bd4f54ed"> 
</p>
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/f449daaa-a198-44bd-92e8-85d7c5769ae4">
</p> 
                 
<br></br>
I decided to place both virtual machines in a NAT Network so they could communicate with each other. This network mode uses a virtual NAT device to route traffic between the inside and the outside network and a separate DHCP server to provide the VMs with IP addresses. All the virtual machines on this network connect to a virtual switch.     

To scan the Windows 10 single host, I first retrieved its IP address. After booting up the Windows 10 VM, I used Command Prompt to run 'ipconfig' and obtain the IPv4 address of the active network adapter. With this information, I can initiate a scan using Nessus Essentials from my Kali Linux VM, ensuring both machines can communicate over the network.

<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/fa59c631-9a8f-4732-954a-a8a080a21aca"> 
</p>

<br></br>
After jumping into my Kali Linux VM and attempting to ping the Windows 10 VM, I notice that none of the packets are being received. In order for these packets to go through, I’m going to have to disable the firewall on the Windows 10 VM. Obviously WOULDN'T do this in a production environment, but for experimentation purposes I’ll proceed.    


<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/8b042c4a-87c9-44e8-a59f-8fb8569e7f78"> 
</p>
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/a938245f-898b-4e08-acf5-a2fe035f900b"> 
</p>
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/18c3e903-cb0a-4718-b19d-860d4462a337"> 
</p>


<br></br>
The firewall is down and packets are being received by the Windows 10 VM. Now we’re good to go!

<p align="center"> 
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/9329db58-cd18-46da-9e62-fd7456b55f83">
</p>
<p align="center"> 
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/6a84a303-44c8-48ce-bfa8-5a24a90fa8f5">
</p>

<h2> <p align="center"> Experimentation </p> </h2> 
First I’ll do a non-credentialed basic network scan of the Windows 10 Single Host.  

<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/100cf269-fea5-4e4d-934c-2aa7529607fb"> 
</p> 
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/f6399b80-b6a6-4857-b111-161c7ed36ef9"> 
</p>

<br></br>
I saved and ran the scan within the Nessus application, which completed in approximately 5 minutes. The scan returned 31 results, with one categorized as medium severity and the rest as informational. Typically, organizations prioritize critical and high-severity vulnerabilities over medium or low ones due to their potential impact. Additionally, since I didn't use credentials for this scan, it's possible that some vulnerabilities weren't detected. Nevertheless, this initial scan provides valuable insights into potential issues, guiding further assessment and mitigation efforts.      

<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/f43d8368-e4c1-49b2-9f6a-2c78bb34bc4e"> 
</p>

<br></br>
Taking a look at the vulnerabilities tab, we see that the one medium rating is for SMB Signing. Server Message Block is a communication protocol used for sharing access to files, printers, serial ports and other resources on a network. Later on in my experimentation I will remediate this vulnerability. Another result that stood out to me was ‘Traceroute Information’. A traceroute was made to the Windows host, which means that ICMP is accepted on it. Some network administrators opt to disable ICMP on devices to evade network mapping applications used by adversaries. In the past, ICMP has been associated with high profile security vulnerabilities, such as the “Ping of Death”. Some devices, such as Cisco routers and various printers, could be brought down by an ICMP ping of a certain packet size. However, this vulnerability has been fixed in modern systems and no longer pose a serious threat.  

<p align="center" >
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/2a44fd7d-4365-45d4-ae35-8876009a726f"> 
</p> 
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/7a0afddd-0bfa-42f5-9b9e-25c1dd5b16aa"> 
</p>

<br></br>
Before proceeding with the second scan, I'm preparing the Windows VM to accept authenticated scans. In the Services app, I enabled Remote Registry, which will allow the scanner to access the VM's registry and identify potential insecure configurations. This step is crucial for conducting thorough vulnerability assessments and prioritizing remediation efforts effectively. By enabling authenticated scans, I aim to gain deeper insights into the system's security posture and enhance proactive risk management.

<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/d050d7ac-b736-428a-8c17-2b4063d65ea6"> 
</p>

<br></br>
Now I need to go into the Registry Editor and add a key that will allow the remote account to connect to the Windows VM during the scan. I navigated to the Registry folder highlighted in green and added a new registry DWORD named ‘LocalAccountTokenFilterPolicy’. I set the value to 1.

<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/cdc8eb63-8bef-4593-ad6a-ab78b7626b9e"> 
</p>

<br></br>
After a quick restart of the Windows VM, it's now primed for a credentialed scan. To initiate this scan, I'll revisit the previous scan and navigate to the credentials tab for editing. Here, I'll input the Windows username and password that I've set up, which in my case are both 'admin'. This step ensures that the scan has privileged access to the system, allowing for a comprehensive assessment of potential vulnerabilities and configuration issues.

<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/1a17a6e2-cc95-4188-933d-e504ef6e094e"> 
</p>

<br></br>
Following the scan, we've identified an increase in vulnerabilities compared to the first assessment. Alongside the medium vulnerability detected previously, high and critical vulnerabilities have surfaced. These issues predominantly stem from outdated or unsupported software running on the Windows VM. Addressing these high and critical vulnerabilities promptly is crucial for bolstering the system's security posture and mitigating potential risks effectively.

<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/c8d0de8b-387b-4159-9157-cecba11ec6b7"> 
</p>

<br></br>  
Before I start remediating these problems, I’m going to install a deprecated version of Firefox onto my Windows VM and run another scan to observe the results. I decided to download Firefox version 43.0 which was released in December 2015.  

<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/7c97d3f8-5179-4dba-b828-5dba9c3babfa"> 
</p>
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/bb3ac2c8-5478-4cda-924d-640b8499b5b3">
</p> 

<br></br>
After running the new scan we can see many new vulnerabilities. 58 critical alone! In the vulnerabilities tab the bulk of problems are shown coming from Mozilla Firefox. The no-brainer here is to eliminate the problem at its source and remove Firefox altogether. 

<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/a9fa9475-0dcb-454e-8c6c-117bfee4e047"> 
</p>

<br></br>
For my remediation plan, I’ll set up priorities of work and navigate through the vulnerabilities from critical to low. Since the third scan encompasses vulnerabilities from previous scans, I'll focus solely on it. No time to waste - let's make it happen!

+ Mozilla Firefox: All I need to do here is uninstall the application itself.
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/18153562-c769-44a5-ba48-2d34fe825930"> 
</p>

<br></br>
+ Microsoft Windows: I need to update Windows to the latest version. The version is so old so it took a few restarts to get it up to date.
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/bc080ec7-b925-4bc4-bf52-e812abe4be34"> 
</p>

<br></br>
+ Microsoft Internet Explorer: Just going to uninstall Internet Explorer since it is no longer supported. Lack of support implies that no new security patches for the product will be released by the vendor. 
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/ec0ab952-cc28-4f8a-99ed-ba9bd6eb4c3e"> 
</p>

<br></br>
+ SMB Signing: When SMB signing is enabled, each SMB message is sent with a signature in the SMB header field. The signature consists of the contents of the SMB message, encrypted with the AES algorithm. When testing a Windows environment, it's regular to see the encrypted password of a user with high privileges being sent across the network. In combination with systems where SMB signing is disabled, an attacker or malicious person can, by performing an NTLM relay attack, increase the privileges within the network. To enable SMB signing, I opened Local Group Policy and then navigated to ‘Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options’. I enabled ‘Microsoft network server: Digitally sign communications (always)’. 
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/bb7cef0f-ad76-4f78-af2e-9452ce090355"> 
</p>

<br></br>
After completing the final scan, we've successfully mitigated all vulnerabilities except for one, which stems from a missing or misconfigured registry key. As a reminder, I had to add this key to the Registry Editor to enable the remote account to connect to the Windows VM for the credentialed scan. 
<p align="center">
<img src="https://github.com/markach151/NessusVulnerabilityManagement/assets/84886088/83026f74-f328-4a3f-b78a-285e66a20ebb"> 
</p>


<h2> <p align="center"> Conclusion </p> </h2>
In conclusion, vulnerability management stands as a continuous and proactive safeguarding process essential for securing computer systems, networks, and enterprise applications against cyber threats and data breaches. Through the utilization of Nessus, I conducted a comprehensive vulnerability assessment of my target, identifying and mapping its attack surface. Subsequently, I successfully mitigated numerous vulnerabilities to minimize the machine's risk exposure. However, the journey doesn't end here. Vulnerability management remains an ongoing endeavor, demanding vigilance against new and emerging threats in ever-evolving environments.
